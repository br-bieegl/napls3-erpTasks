var defaultMapingValue=new Array(0x00,0x01,0x02,0x03,0x04,0x05,0x06,0x07,0x08,0x0a,0x0b,0x09,0x0c,0x14,0x15,0x16,0x17,0x12,0x01,0x02,0x11,0x16,0x03,0x06,0x13,0x14,0x04,0x15,0x05);var defaultMapingType=new Array(2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,1,1,1,1,1,1,1,1,1,1);$(document).ready(MJ_init);function MJ_init(){common();$("#keyboard").dialog({show:'blind',hide:'blind',resizable:false,modal:false,height:265,width:780,autoOpen:false});$("#keyboard button").click(function(){$('#te_'+keyindex+' select').val($(this).attr("value"));$("#keyboard").dialog('close')});$("#SaveDialog").dialog({show:'blind',hide:'blind',resizable:false,modal:false,height:160,width:300,autoOpen:false});$("#OpenDialog").dialog({show:'blind',hide:'blind',resizable:false,modal:false,height:130,width:300,autoOpen:false});setDefault();$("#ProfileDefault").click(function(){setDefault()});$('#ProfileSavedList').change(function(){$("#ProfileName").attr("value",$("#ProfileSavedList").find("option:selected").text())});$("#ProfileSaveCancel").click(function(){$("#SaveDialog").dialog('close')});if(VersionTool>0){if(VersionTool>0x060000){$("#ProfileEnable").click(function(){var i=0;$('.tdselect').each(function(){SetProfileCommandValue(i,0,$(this).val());SetProfileCommandValue(i,1,parseInt($('#te_'+$(this).attr('name')+' select').val()));i++});EnableConfig(0,0,0);mmm()});$("#ProfileOpen").click(function(){mmm();GetprofileList();$("#OpenDialog").dialog('open')});$("#ProfileSave").click(function(){mmm();GetprofileList();$("#SaveDialog").dialog('open')});$("#ProfileSaveOk").click(function(){var name=$("#ProfileName").attr("value");if(name!=""){var i=0;$('.tdselect').each(function(){SetProfileCommandValue(i,0,$(this).val());SetProfileCommandValue(i,1,parseInt($('#te_'+$(this).attr('name')+' select').val()));i++});SaveProfile(name);$("#SaveDialog").dialog('close')}});$("#ProfileSaveDel").click(function(){var name=$("#ProfileName").attr("value");if(name!=""){DeletProfile(name);GetprofileList();$("#ProfileName").attr("value","")}});$("#ProfileSelectOk").click(function(){ChangeProfile($("#OpenPList").find("option:selected").text());var i=0;$('.tdselect').each(function(){setJoystickMap(i,GetProfileCommandValue(i,0),parseInt(GetProfileCommandValue(i,1)),GetProfileCommandValue(i,2));i++});$("#OpenDialog").dialog('close')});$("#ProfileImport").click(function(){mmm();ImportProfile();GetInfo()});$("#ProfileExport").click(function(){mmm();ExportProfile()});GetInfo()}else if(VersionTool>=0x050000){window.external.configDevice2(4,0,0,0,0,'');window.external.configDevice2(4,0,4,0,0,'');$("#ProfileEnable").click(function(){Mconfig();ProfileEnable()});$("#ProfileSave").click(function(){window.external.configDevice2(4,0,0,0,0,'');$("#SaveDialog").dialog('open');Mconfig()});$("#ProfileOpen").click(function(){window.external.configDevice2(4,0,0,0,0,'');$("#OpenDialog").dialog('open');Mconfig()});$("#ProfileSaveOk").click(function(){var name=$("#ProfileName").attr("value");if(name!=""){ProfileEnable();window.external.configDevice2(4,0,2,1,0,name);$("#SaveDialog").dialog('close')}});$("#ProfileSaveDel").click(function(){var name=$("#ProfileName").attr("value");if(name!=""){window.external.configDevice2(4,0,2,0,0,name);window.external.configDevice2(4,0,0,0,0,'')}});$("#ProfileSelectOk").click(function(){window.external.configdevice2(4,0,1,0,0,$("#OpenPList").find("option:selected").text());$("#OpenDialog").dialog('close')});$("#ProfileImport").click(function(){Mconfig();window.external.configDevice2(4,0,6,0,0,'')});$("#ProfileExport").click(function(){Mconfig();window.external.configDevice2(4,0,7,0,0,'')})}else{$("#ProfileSave").click(function(){window.external.configDevice(5,0,0,0,0,0);$("#SaveDialog").dialog('open');Mconfig()});$("#ProfileOpen").click(function(){window.external.configDevice(5,0,0,0,0,0);$("#OpenDialog").dialog('open');Mconfig()});$("#ProfileSaveOk").click(function(){var name=$("#ProfileName").attr("value");if(name!=""){ProfileEnable();window.external.saveProfile(name,1)}$("#SaveDialog").dialog('close')});$("#ProfileSaveDel").click(function(){var name=$("#ProfileName").attr("value");if(name!=""){window.external.saveProfile(name,0);window.external.configDevice(5,0,0,0,0,0)}});$("#ProfileSelectOk").click(function(){window.external.SelectProfile($("#OpenPList").find("option:selected").text());$("#OpenDialog").dialog('close')})}}}function GetInfo(){var i=0;$('.tdselect').each(function(){setJoystickMap(i,GetProfileCommandValue(i,0),parseInt(GetProfileCommandValue(i,1)),GetProfileCommandValue(i,2));i++});GetprofileList()}function setDefault(){var str=$('#tds0').html();for(var i=0;i<defaultMapingType.length;i++){$("#td_"+i).html(str);$("#td_"+i+' select').attr('name',i);$("#td_"+i+' select').addClass('tdselect');$("#td_"+i+' select').val(defaultMapingType[i])}$('.tdselect').change(function(){tdselectChange(this)});$('.tdselect').change()}function tdselectChange(obj){var tdname=$(obj).attr('name');keyindex=tdname;$('#te_'+tdname).html($('#tes'+$(obj).val()).html());$('#te_'+tdname).unbind("click");if($(obj).val()==1||$(obj).val()==2){$('#te_'+tdname+' select').val('0x'+(defaultMapingValue[parseInt(tdname)]).toString(16))}if($(obj).val()==3){$('#te_'+$(obj).attr('name')).click(function(){keyindex=$(this).attr('name');$("#keyboard").dialog('open')})}}function ProfileList(){if(arguments.length>2){var i=0;if(arguments[1]>0){$(".ProfileList").html("");if(VersionTool<0x060000){for(i=0;i<arguments[1];i++){$('<option value="'+i+'">'+arguments[i+2]+'</option>').appendTo('.ProfileList')}}else{for(i=0;i<arguments[1];i++){$('<option value="'+i+'">'+arguments[i+10]+'</option>').appendTo('.ProfileList')}}}}}function setJoystickMap(Index,CType,CVal,desc){$("#td_"+Index+' select').val(CType);$("#td_"+Index+' select').change();$('#te_'+Index+' select').val("0x"+CVal.toString(16))}function ProfileEnable(){var i=0;$('.tdselect').each(function(){if(VersionTool>=0x050000){window.external.configDevice2(4,i,3,$(this).val(),parseInt($('#te_'+$(this).attr('name')+' select').val()),'');if(VersionTool>=0x060000){window.external.configDevice(2,0xff,0,0,0,0)}else{window.external.configDevice(2,0,0,100,100,1)}}else{window.external.setJoystickMap(i,$(this).val(),parseInt($('#te_'+$(this).attr('name')+' select').val()),'')}i++})}